<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Favicons, meta, fonts, etc. -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title> Login</title>
    <script src="https://kit.fontawesome.com/64d58efce2.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style2.css') }}">
    <link href="https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/login.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link rel="shortcut icon" href="{{ url_for('static', filename='images/fav-icon.png') }}" />
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Heebo:wght@100;200;300;400;500;600;700;800;900&family=Roboto:wght@100;300;400;500;700;900&display=swap"
      rel="stylesheet" />
    <script src="https://kit.fontawesome.com/c8e4d183c2.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  </head>
  <body>
    <section class="login">
      <div class="container">
        <div class="forms-container">
          <div class="signin-signup">
            <!-- User Login Form -->
            <form action="{{ url_for('user_login_submit') }}" method="POST" id="login_form" class="sign-in-form alignment">
              <h2 class="title user_logged_in">User Login</h2>
            
              {% if error %}
                <script>
                  window.alert("{{ error }}");
                </script>
              {% endif %}
            
              <div class="input-field user_logged_in" style="margin-right: 70px">
                <i class="fas fa-user"></i>
                <input type="email" name="email" id="user_email" placeholder="Email" required autofocus />
              </div>
            
              <div class="input-field user_logged_in password" style="margin-right: 70px">
                <i class="fas fa-lock lock"></i>
                <input type="password" name="password" id="user_password" placeholder="Password" required />
                <i class="fas fa-eye-slash eye" id="eye"></i>
              </div>
            
              <span id="err_msg"></span>
            
              <div class="proper" style="margin-right: 50px">
                <input type="submit" value="SIGN IN" class="btn solid user_logged_in" />
              </div>
              <!-- Forgot Password link added below the sign in button -->
              <div class="forgot-password">
                <a href="{{ url_for('forgot_password_user') }}">Forgot Password?</a>
              </div>
            </form>
            
            <!-- Institutional Login Form -->
            <form id="signup_form" class="sign-up-form" method="POST" action="{{ url_for('login_submit') }}">
              <h2 class="title">Institutional Login</h2>
              {% if error %}
                <script>
                  window.alert("{{ error }}");
                </script>
              {% endif %}
              <div class="input-field">
                <i class="fas fa-envelope"></i>
                <input type="email" name="email" id="signup_email" placeholder="Email" required />
              </div>
              <div class="input-field password">
                <i class="fas fa-lock lock"></i>
                <input type="password" name="password" id="signup_password" placeholder="Password" required />
                <i class="fas fa-eye-slash eye" id="signup_eye"></i>
              </div>
              <span id="err_msg_signup"></span>
              <input type="submit" class="btn" value="SIGN IN" />
              <!-- Forgot Password link added below the sign in button -->
              <div class="forgot-password">
                <a href="{{ url_for('forgot_password_institution') }}">Forgot Password?</a>
              </div>
            </form>

          </div>
        </div>

        <div class="panels-container">
          <div class="panel left-panel">
            <div class="content">
              <h3 id="signed_user_welcome">Institution</h3>
              <p>Login as an institution using institution credentials.</p>
              <button class="btn transparent user_logged_in" id="sign-up-btn">
                SIGN IN
              </button>
            </div>
            <img src="{{ url_for('static', filename='img/log.svg') }}" alt="" class="image">
          </div>
          <div class="panel right-panel">
            <div class="content">
              <h3>User</h3>
              <p>Login as a user using user credentials</p>
              <button class="btn transparent" id="sign-in-btn">SIGN IN</button>
            </div>
            <img src="{{ url_for('static', filename='img/register.svg') }}" alt="" class="image">
          </div>
        </div>
      </div>
    </section>
    <!-- Include your JavaScript files -->
    <script src="{{ url_for('static', filename='js/logscript1.js') }}"></script>
    <script src="{{ url_for('static', filename='js/logscript2.js') }}"></script>
    <script src="https://unpkg.com/@supabase/supabase-js"></script>
    <script src="{{ url_for('static', filename='js/logscript3.js') }}"></script>
    <script src="{{ url_for('static', filename='js/login.js') }}"></script>
    <script src="{{ url_for('static', filename='js/signup.js') }}"></script>
    <script src="{{ url_for('static', filename='js/user_state.js') }}"></script>
    <script>
      window.addEventListener("load", function() {
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            swal({
              title: "{{ category.capitalize() }}",
              text: "{{ message }}",
              icon: "{{ 'success' if category == 'success' else 'error' }}",
              button: "OK"
            });
          {% endfor %}
        {% endif %}
        {% endwith %}
      });
    </script>
  </body>
</html>
